<ion-header [translucent]="true">
  <ion-toolbar>
    <app-header [title]="'Galería'"></app-header>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="galeria-page ion-padding">

  <!-- Segmento: pestañas Imágenes / Videos -->
  <ion-segment [(ngModel)]="segmentValue" (ionChange)="segmentChanged($event)" mode="md" value="imagenes">
    <ion-segment-button value="imagenes">
      <ion-label>Imágenes</ion-label>
    </ion-segment-button>
    <ion-segment-button value="videos">
      <ion-label>Videos</ion-label>
    </ion-segment-button>
  </ion-segment>

  <!-- Sección Imágenes -->
  <div *ngIf="segmentValue === 'imagenes'">
    <ion-card *ngFor="let img of imagenes$ | async">
      <img [src]="img.url_imagen" alt="{{ img.titulo }}">
      <ion-card-content>
        <h2>{{ img.titulo }}</h2>
        <p>{{ img.descripcion }}</p>
        <small>Subido el: {{ img.fecha_subida | date }}</small>
      </ion-card-content>
    </ion-card>
  </div>

  <!-- Sección Videos -->
  <div *ngIf="segmentValue === 'videos'">
    <ion-card *ngFor="let vid of videos$ | async">
      <ion-card-content>
        <h2>{{ vid.titulo }}</h2>
        <p>{{ vid.descripcion }}</p>

        <!-- Si es un enlace de YouTube -->
        <iframe
          *ngIf="vid.video.includes('youtube.com') || vid.video.includes('youtu.be')"
          width="100%"
          height="200"
          [src]="getSafeUrl(vid.video)"
          frameborder="0"
          allowfullscreen>
        </iframe>

        <!-- Si es un enlace directo (mp4, etc.) -->
        <video
          *ngIf="!vid.video.includes('youtube.com') && !vid.video.includes('youtu.be')"
          width="100%"
          height="auto"
          controls
          [src]="vid.video">
        </video>

        <small>Publicado el: {{ vid.fecha_publicacion | date }}</small>
      </ion-card-content>
    </ion-card>
  </div>

</ion-content>
